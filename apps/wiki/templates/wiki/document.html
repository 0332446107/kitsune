{# vim: set ts=2 et sts=2 sw=2: #}
{% extends "wiki/base.html" %}
{% from "wiki/includes/sidebar_modules.html" import document_tabs, for_contributors, document_notifications, quick_links %}
{# L10n: {t} is the title of the document. {c} is the category. #}
{% set title = _('{t} | {c}')|f(t=document.title, c=document.get_category_display()) %}
{% set classes = 'document' %}

{% block content %}
  <article id="wiki-doc" class="main">
    <section id="related-articles">
      <h1> {{ _('Related Articles') }}</h1>
      <ul>
        {# TODO: implement backend for this list #}
        <li><a href="#">Lorem ipsum dolor</a></li>
        <li><a href="#">Lorem ipsum dolor sit amet</a></li>
        <li><a href="#">Lorem ipsum dolor</a></li>
        <li><a href="#">Lorem ipsum dolor sit amet</a></li>
        <li><a href="#">Lorem ipsum dolor</a></li>
      </ul>
    </section>
    <h1 class="title">{{ document.title }}</h1>
    {% if redirected_from %}
      <div id="redirected-from">
        {{ _('(Redirected from <a href="{href}">{title}</a>)')|fe(href=redirected_from.get_absolute_url()|urlparams(redirect='no'), title=redirected_from.title) }}
      </div>
    {% endif %}
    <section id="doc-content">
      {% if document.current_revision %}
        {{ document.html|safe }}
      {% else %}
        {{ _("This article doesn't have approved content yet.") }}
      {% endif %}
    </section>
  </article>
  {% if not document.has_voted(request) %}
    <div id="helpful-vote">
      <form class="helpful" action="{{ url('wiki.document_vote', document_slug=document.slug) }}" method="post">
        {{ csrf() }}
        <p>
          {{ _('Was this article helpful?') }}
          <input type="submit" class="btn" name="helpful" value="{{ _('Yes') }}" />
          <input type="submit" class="btn" name="not-helpful" value="{{ _('No') }}" />
          <img class="wait" src="{{ settings.MEDIA_URL }}img/customercare/spinner.gif" alt="{{ _('Please wait...') }}" />
        </p>
      </form>
    </div>
  {% endif %}
  <div id="more-help">
    <h2>{{ _("Couldn't find what you were looking for?") }}</h2>
    <ul>
      <li>
        {{ _('Browse a list of related articles') }}
        <ul>
          {# TODO: implement backend for this list #}
          <li><a href="#">Lorem ipsum dolor</a></li>
          <li><a href="#">Lorem ipsum dolor sit amet</a></li>
          <li><a href="#">Lorem ipsum dolor</a></li>
          <li><a href="#">Lorem ipsum dolor sit amet</a></li>
          <li><a href="#">Lorem ipsum dolor</a></li>
        </ul>
      </li>
      <li>
        {{ _('Browse other articles about <a href="{url}">{category}</a>')|fe(url=url('wiki.category', document.category), category=document.get_category_display()) }}
      </li>
      <li>
        {{ _('Ask your question to our helpful<br /> <a href="{url}">Support Community</a>')|fe(url=url('questions.new_question')) }}
      </li>
    </ul>
    {{ search_box(settings, id=False, prefix='Try Searching Instead:') }}
  </div>
{% endblock %}

{% block side %}
  {{ document_tabs(document, document.parent, user, 'article', settings) }}

  {% if user.is_authenticated() and document %}
    <div id="doc-watch">
      {% if is_watching(document, user) %}
        <form action="{{ url('wiki.document_unwatch', document.slug) }}" method="post">
          {{ csrf() }}
          <input type="submit" class="submit" value="{{ _('Unsubscribe from edit notifications') }}" />
        </form>
      {% else %}
        <form action="{{ url('wiki.document_watch', document.slug) }}" method="post">
          {{ csrf() }}
          <input type="submit" class="submit" value="{{ _('Subscribe to edit notifications') }}" />
        </form>
      {% endif %}
    </div>
  {% endif %}

  {{ for_contributors() }}
  {{ quick_links() }}
  {% include 'wiki/includes/support_for_selectors.html' %}
{% endblock %}
